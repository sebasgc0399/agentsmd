# AGENTS.md

## Propósito del repositorio
{{project_description}}

## Tech stack
{{#stacks}}
- {{.}}
{{/stacks}}

## Comandos canónicos
- Instalar dependencias: `{{commands.install}}`
{{#has_dev}}
- Ejecutar emuladores locales: `{{commands.dev}}`
{{/has_dev}}
- Deploy a Firebase: `firebase deploy --only functions`
{{#has_build}}
- Build: `{{commands.build}}`
{{/has_build}}
{{#has_lint}}
- Lint: `{{commands.lint}}`
{{/has_lint}}
{{#has_tests}}
- Tests: `{{commands.test}}`
{{/has_tests}}

## Definition of Done
Antes de considerar una tarea completa:
{{#has_tests}}
- [ ] `{{commands.test}}` pasa sin errores
{{/has_tests}}
{{#has_lint}}
- [ ] `{{commands.lint}}` pasa sin errores
{{/has_lint}}
- [ ] Probado localmente con emuladores de Firebase
- [ ] No añadir dependencias nuevas sin confirmación
- [ ] Revisar quotas y límites de Firebase

## Estilo y convenciones
{{style_notes}}

### Funciones Firebase
- Funciones idempotentes (mismo input = mismo output)
- Manejar cold starts: minimizar dependencias globales
- Usar `onCall` para funciones HTTPS callable, `onRequest` para endpoints REST
- Timeout configurado según caso de uso (default 60s, max 540s)

## Environment variables
- Variables de configuración en `.env` (local) y Firebase Config (producción)
- Secrets en Google Secret Manager, accedidos via `functions.config()`
- NO hardcodear API keys, tokens, o credenciales

{{#has_tests}}
## Testing guidelines
{{testing_notes}}

### Estrategia de testing
- Unit tests para lógica de negocio (sin Firebase)
- Integration tests con emuladores de Firebase
- Mocking de Firebase Admin SDK cuando sea necesario
{{/has_tests}}

## Seguridad
{{security_notes}}

### Firebase-specific
- Validar todos los inputs en funciones callable
- Usar Firebase Auth para autenticación
- Implementar Security Rules en Firestore/Storage
- Nunca exponer Service Account keys en código

## Deployment
- Deploy staging: `firebase deploy --only functions --project staging`
- Deploy producción: `firebase deploy --only functions --project production`
- Rollback: `firebase functions:delete FUNCTION_NAME` + redeploy versión anterior

---
*Generated by agents-md v1.0.0*
